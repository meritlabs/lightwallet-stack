<ion-header>

    <ion-navbar color="secondary">
        <ion-title>Amount</ion-title>
    </ion-navbar>

</ion-header>


<ion-content>


    <span *ngIf="wallet && hasFunds" margin-top>

        <span class="row">
            <span class="label" text-left>Recipient</span>
            <span text-right [style.flex]="1" padding-right >
                {{ displayName | slice:0:15}}
                <span class="avatar">
                    <img [src]="sanitizePhotoUrl(contact.photos[0].value)" *ngIf="contact.photos.length">
                    <gravatar class="send-gravatar"
                              [name]="contact.name.formatted" width="30" height="30"
                              [email]="contact.emails[0] ? contact.emails[0].value : ''" *ngIf="!contact.photos.length"></gravatar>
                </span>
            </span>
        </span>


        <div class="row">
            <span text-left class="label">Send via</span>
            <span item-right text-right [style.flex]="1" (click)="selectSendingOption()" padding-right>
                {{recipient.label}}
            </span>
        </div>

        <div class="label" class="row" (click)="selectWallet()">
            <span text-left class="label">From</span>
            <span item-right text-right [style.flex]="1">
                {{wallet.name || wallet._id}} ({{ availableAmount ? availableAmount.formatted : ''}})
                <button ion-button icon-only clear color="primary" class="wallet-button">
                    <i class="wallet-icon" item-start [class.locked]="wallet.locked" [class.default]="!wallet.color" [style.background]="wallet.color">
                        <img src="assets/img/icon-wallet.svg">
                    </i>
                </button>
            </span>
        </div>

        <div class="row">
            <span class="label" text-left>Amount</span>
            <ion-input type="number" text-right pattern="[0-9\.]"
                   [style.flex]="1"
                   [ngModel]="amount"
                   (ionChange)="processAmount($event.value)"
                   [placeholder]="'Enter sending amount'"></ion-input>
            <button ion-button clear color="primary" (click)="toggleCurrency()">
                {{amountCurrency}}
            </button>
        </div>
        <div class="row">
            <span class="label" text-left>Fee <span *ngIf="feePercent">({{feePercent}})</span></span>
            <span text-right [style.flex]="1" padding-right>

                <ion-spinner *ngIf="amount && !feeMrt && !feeCalcError" ></ion-spinner>
                <span *ngIf="!amount">0.0</span>
                <span *ngIf="amount && feeMrt">
                    <span *ngIf="amountCurrency == 'MRT'">{{feeMrt}}</span>
                    <span *ngIf="amountCurrency != 'MRT'">{{feeFiat}}</span>
                    {{amountCurrency}}
                </span>
                <span *ngIf="feeCalcError" class="error">{{feeCalcError}}</span>

            </span>
        </div>
        <div class="row">
            <span class="label" text-left>Recipient pays fee.</span>
            <span [style.flex]="1">

            </span>
            <div class="toggle-wrapper">
                <ion-toggle [(ngModel)]="feeIncluded" (ionChange)="toggleFeeIncluded($event)"></ion-toggle>
            </div>
        </div>
        <div class="row">

            <span class="label" text-left>Available</span>
            <span text-right [style.flex]="1" padding-right >
                {{ availableAmount.formatted }}
            </span>
        </div>


        <div class="control-buttons">
            <button ion-button primary margin-top (click)="toConfirm()" [disabled]="!sendAllowed()" >Send</button>
        </div>

    </span>

    <span *ngIf="!loading && !hasFunds">
        <div text-center padding>Before sending Merit you should buy some!</div>
        <div class="control-buttons">
            <button ion-button primary margin-top (click)="toBuyAndSell()">Buy Merit</button>
        </div>
    </span>

</ion-content>

