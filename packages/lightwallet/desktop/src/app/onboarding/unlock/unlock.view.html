<ng4-loading-spinner></ng4-loading-spinner>
<app-slider-guide *ngIf="showGuide" (hideGuide)="hideGuide($event)" [showGuide]="showGuide"></app-slider-guide>
<div class="container--fluid unlock">
  <div class="unlock__content container">
    <div class="container--fluid unlock__heading">
      <div class="unlock__heading__picture">
        <img src="assets/v1/images/unlock/invite.svg" alt="Merit is invite-only network">
      </div>
      <div class="unlock__heading__title title--primary">
        <ng-container *ngIf="easyReceipt; else noEasyReceipt">
          <h1>{{ easyReceipt.senderName | unescape }} sent you Merit!</h1>
        </ng-container>
        <ng-template #noEasyReceipt>
          <h1><span routerLink="../" class="unlock__back"><img src="/assets/v1/images/backup/back-icon.svg" alt=""></span>
            Merit is invite-only network</h1>
        </ng-template>
      </div>
    </div>
    <form class="unlock__form" [formGroup]="formData" (ngSubmit)="onSubmit()">
      <div class="ui-input__group">
        <label for="" class="ui-label">
          Invite code
          <span class="ui-tooltip">
            <span class="ui-tooltip__text">
              You need an invite code from a friend or colleague.
            </span>
          </span>
        </label>
        <input type="text" formControlName="inviteCode" class="ui-input ui-input--text"
        [ngClass]="{'ui-input--valid': !inviteCode.hasError('required') && !inviteCode.hasError('minlength') && !inviteCode.hasError('InvalidFormat') && !inviteCode.hasError('AddressNotFound'),
          'ui-input--invalid': !inviteCode.hasError('required') }">
        <div class="input-errors" [hidden]="!inviteCode.dirty || inviteCode.valid">
          <div [hidden]="!inviteCode.hasError('required')">
            <span class="tooltip-error">
              <span>Invite code is required</span>
            </span>
          </div>
          <div [hidden]="inviteCode.hasError('required') || !inviteCode.hasError('minlength')">
            <span class="tooltip-error">
              <span>Invite code must be at least 3 characters long</span>
            </span>
            </div>
          <div [hidden]="inviteCode.hasError('required') || !inviteCode.hasError('InvalidFormat')">
            <span class="tooltip-error">
              <span>Invalid address or alias format</span>
            </span>
          </div>
          <div [hidden]="inviteCode.hasError('required') || !inviteCode.hasError('AddressNotFound')">
            <span class="tooltip-error">
              <span>Address not found</span>
            </span>
          </div>
        </div>
        <div class="ui-input__group__tipbox" *ngIf="!inviteCode.valid">
          Please enter "Invite code" which you recieved from your friend or colleague,
          after code entering you will proceed to the next step =)
        </div>
      </div>
      <div class="ui-input__group" [ngClass]="{'ui-input__group--disabled': !inviteCode.valid}" *ngIf="inviteCode.valid">
        <label for="" class="ui-label">
          Your username (alias)
          <span class="ui-tooltip">
              <span class="ui-tooltip__text">
                Add alias to your address, so people can recognize you and type something like "@merituser" instead of address.
              </span>
            </span>
        </label>
        <input type="text" class="ui-input ui-input--text" formControlName="alias"
        [ngClass]="{'ui-input--valid': alias.dirty && alias.valid,
          'ui-input--invalid': alias.dirty && !alias.valid}">
        <div class="input-errors" [hidden]="!alias.dirty || alias.valid">
          <div [hidden]="!alias.hasError('minlength')">
            <span class="tooltip-error">
              <span>Your alias must be at least 3 characters long</span>
            </span>
          </div>
          <div [hidden]="!alias.hasError('InvalidFormat')">
            <span class="tooltip-error">
              <span>Invalid alias format</span>
            </span>
          </div>
          <div [hidden]="!alias.hasError('AliasInUse')">
            <span class="tooltip-error">
              <span>Alias is already in use</span>
            </span>
          </div>
        </div>
        <div class="ui-input__group__tipbox" *ngIf="!alias.valid && !alias.hasError('AliasInUse')">
          Please create and enter your Uniq network alias, it will be used for identify you
          in the Merit World. Be careful, entered name canntot be changed after unlocking process.
        </div>
      </div>
      <div class="unlock__form__group" *ngIf="!formData.invalid && alias.valid">
        <div class="ui-button ui-button--blue ui-button--with-arrow" (click)="showAgreement = !showAgreement">NEXT</div>
      </div>
    </form>
    <div class="userAgreement" *ngIf="showAgreement">
      <div class="userAgreement_content">
        <h2 class="content_title">
          <div class="import_back" (click)="showAgreement = !showAgreement">
            <img src="/assets/v1/images/backup/back-icon.svg" alt="">
          </div>Wallet unlock confirmation
        </h2>
        <div class="content_details">
          <p>Invite address: <strong>{{inviteCode.value}}</strong></p>
          <p>Your username(alias): <strong>{{alias.value}}</strong></p>
        </div>
        <div class="content_warning">
          <p><strong>*</strong> Be carefull you cant change your alias in the future.</p>
          <p><strong>**</strong> You will recieve your uniq password after these conditions aprovement.</p>
        </div>
        <div class="content_checkbox">
          <div class="ui-checkbox">
              <input type="checkbox"[(ngModel)]="userAgreement">
              <span class="ui-checkbox__switcher"></span>
              <strong>I agree with these conditions.</strong>
          </div>
        </div>
        <button class="ui-button ui-button--blue ui-button--with-arrow"
          role="button" type="submit" [disabled]="!userAgreement"
          (click)="onSubmit()">Let's get started</button>
      </div>
    </div>
    <div class="already-member" [hidden]="!alias.hasError('AliasInUse')">
      <p>Oooops! Looks like you try to reuse existing username (alias).</p>
      <p>If it is true you can <a routerLink="../import">import wallet</a></p>
      <p>If no, please choose another username (alias)</p>
    </div>
  </div>
</div>
