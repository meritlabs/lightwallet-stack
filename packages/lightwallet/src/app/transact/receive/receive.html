<ion-header>

    <ion-navbar color="secondary">
        <ion-title>Receive Merit</ion-title>
        <ion-buttons end>
            <button ion-button icon-only (click)="share()">
                <ion-icon name="share"></ion-icon>
            </button>
        </ion-buttons>
    </ion-navbar>

</ion-header>


<ion-content>

    <ion-card *ngIf="wallet && !wallet.isComplete()" margin-top> 
        <ion-card-header translate>This wallet is incomplete.</ion-card-header>
        <ion-card-content translate>
            All signing devices must be added to this multisig wallet before merit addresses can be created.
        </ion-card-content>

        <button (click)="toCopayers()" ion-button>Open Wallet</button>
    </ion-card>

    <div class="container" *ngIf="wallet && wallet.isComplete() && qrAddress && !addressGenerationInProgress">

        <qr-code *ngIf="address" [value]="qrAddress" [level]="M" [size]="220" [foreground]="'#334'"></qr-code>
        <div  class="address" (click)="copyToClipboard(address)"  [clip]="qrAddress">{{qrAddress}}</div>
    </div>

    <div class="container">
        <div class="spinner-wrapper" *ngIf="addressGenerationInProgress">
            <ion-spinner></ion-spinner>
        </div>
    </div>


    <div class="container" *ngIf="wallet && wallet.isComplete() && !qrAddress && !addressGenerationInProgress">
        No address available for this wallet
    </div>



</ion-content>

<ion-footer >
    <ion-toolbar>

        <ion-item *ngIf="!wallet">
            <ion-label translate>You don't have any wallet</ion-label>
        </ion-item>


        <span *ngIf="wallet">

             <div class="row error" *ngIf="mainAddressGapReached" >
                 <span [style.flex]="1"  text-right>Maximum number of consecutive addresses without activity reached</span>
             </div>

            <div class="row">
                <span class="label" text-left>Amount</span>
                <input type="number"
                       [style.flex]="1"
                       text-right
                       pattern="[0-9\.]"
                       [(ngModel)]="amount"
                       (ngModelChange)="changeAmount()"
                       [placeholder]="'Request specific amount (optional)'">
                <button ion-button clear color="primary" (click)="toggleCurrency()">
                    {{amountCurrency}}
                </button>
            </div>


            <div class="row">
                <span class="label" text-left >Address</span>
                <span item-right text-right [style.flex]="1" [style.font-size]="'10px'" (click)="copyToClipboard(address)" [clip]="address">
                    <span *ngIf="address">{{address}}</span>
                    <span *ngIf="!address && error" class="error">{{error}}</span>
                </span>
                <button ion-button icon-only clear color="primary" (click)="generateAddress(forceNew = true)"  class="select-button" *ngIf="!addressGenerationInProgress">
                    <ion-icon name="refresh"></ion-icon>
                </button>
                <button ion-button icon-only clear color="primary" class="select-button" *ngIf="addressGenerationInProgress">
                    <ion-spinner color="primary"></ion-spinner>
                </button>
            </div>

             <div class="label" class="row" (click)="selectWallet()">
                 <span text-left class="label">Receive in</span>
                 <span item-right text-right [style.flex]="1">
                     {{wallet.name || wallet._id}}
                     <button ion-button icon-only clear color="primary"  class="wallet-button">
                         <i class="wallet-icon" item-start [class.locked]="wallet.locked" [class.default]="!wallet.color" [style.background]="wallet.color">
                             <img src="assets/img/icon-wallet.svg"   >
                         </i>
                     </button>
                 </span>
             </div>
        </span>

    </ion-toolbar>
</ion-footer>
