<ion-header no-border>
  <ion-navbar color="light">
    <ion-title>Receive Merit</ion-title>
  </ion-navbar>
</ion-header>

<ion-content>

  <ion-card *ngIf="wallet && !wallet.isComplete()" margin-top>
    <ion-card-header>This wallet is incomplete.</ion-card-header>
    <ion-card-content>
      All signing devices must be added to this multisig wallet before merit addresses can be created.
    </ion-card-content>
    <button (click)="toCopayers()" ion-button>Open Wallet</button>
  </ion-card>

  <div class="container" *ngIf="wallet && wallet.isComplete() && qrAddress && !addressGenerationInProgress">
    <qr-code *ngIf="address" [value]="qrAddress" [level]="M" [size]="220" [foreground]="'#334'"></qr-code>
    <div class="address" (click)="copyToClipboard(address)" [clip]="qrAddress">{{ qrAddress }}</div>
  </div>

  <div class="container">
    <div class="spinner-wrapper" *ngIf="addressGenerationInProgress">
      <ion-spinner></ion-spinner>
    </div>
  </div>

  <div class="container" *ngIf="wallet && wallet.isComplete() && !qrAddress && !addressGenerationInProgress">
    No address available for this wallet
  </div>


</ion-content>

<ion-footer>
  <ion-toolbar>

    <ion-item *ngIf="!wallet">
      <ion-label>
        <h2>You don't have any wallets</h2>
      </ion-label>
    </ion-item>


    <div *ngIf="wallet">

      <div class="row error" *ngIf="mainAddressGapReached">
        <span style="flex: 1" text-right>Maximum number of consecutive addresses without activity reached</span>
      </div>

      <ion-list>
        <ion-item>
          <ion-avatar img-icon item-start>
            <img src="assets/img/icons/request amount.svg" alt="">
          </ion-avatar>
          <ion-label stacked>Request Amount (optional)</ion-label>
          <!-- TODO: no currency toggle? -->
          <ion-input type="number" pattern="[0-9\.]" min="0" [(ngModel)]="amount" (ionChange)="changeAmount()" placeholder="0.00 MRT"></ion-input>
        </ion-item>

        <button ion-item (click)="copyToClipboard(address)" [clip]="address">
          <ion-avatar img-icon item-start>
            <img src="assets/img/icons/merit.svg" alt="">
          </ion-avatar>
          <ion-label stacked>
            <p>Merit Address</p>
            <h2>{{ address }}</h2>
          </ion-label>
        </button>

        <button ion-item (click)="selectWallet()">
          <ion-avatar img-icon item-start>
            <img src="assets/img/icons/wallet.svg" alt="">
          </ion-avatar>
          <ion-label stacked>
            <p>Receive to</p>
            <h2>{{ wallet.name || wallet._id }}</h2>
          </ion-label>
        </button>
      </ion-list>


      <!--<div class="row">-->
        <!--<span class="label" text-left>Address</span>-->
        <!--<span item-right text-right [style.flex]="1" [style.font-size]="'10px'"-->
              <!--(click)="copyToClipboard(address)" [clip]="address">-->
                    <!--<span *ngIf="address">{{address}}</span>-->
                    <!--<span *ngIf="!address && error" class="error">{{error}}</span>-->
                <!--</span>-->
        <!--<button ion-button icon-only clear color="primary" (click)="generateAddress(true)" class="select-button"-->
                <!--*ngIf="!addressGenerationInProgress">-->
          <!--<ion-icon name="refresh"></ion-icon>-->
        <!--</button>-->
        <!--<button ion-button icon-only clear color="primary" class="select-button"-->
                <!--*ngIf="addressGenerationInProgress">-->
          <!--<ion-spinner color="primary"></ion-spinner>-->
        <!--</button>-->
      <!--</div>-->
    </div>

  </ion-toolbar>
</ion-footer>
