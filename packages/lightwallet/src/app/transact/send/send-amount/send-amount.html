<ion-header>
    <ion-navbar color="light">
        <ion-title *ngIf="recipient.name?.formatted">
            <h2>Recipient: {{recipient.name.formatted}}</h2>
            <p>via {{sendMethod.value|slice:0:25}}</p>
        </ion-title>
        <ion-title *ngIf="!recipient.name?.formatted">
            <h2>{{sendMethod.type == 'easy' ? 'Easy Send to' : 'Classic Send to'}}</h2>
            <p>{{sendMethod.value}}</p>
        </ion-title>
    </ion-navbar>
</ion-header>

<ion-content>
    <div *ngIf="!loading">

        <div class="amount-area">

            <div class="currency-bar">
                <div *ngFor="let currency of availableUnits" (click)="selectCurrency(currency)"
                     class="currency" [class.selected]="currency.type == selectedCurrency.type">
                    {{currency.name}}
                    <div class="selected-mark" *ngIf="currency.type == selectedCurrency.type"></div>
                </div>
            </div>

            <div class="main-amount">
                <ion-input
                        pattern="[0-9\.]"
                        [(ngModel)]="formData.amount"
                        (ngModelChange)="processAmount($event)"
                        [placeholder]="'Enter sending amount'"
                ></ion-input>
            </div>
            <div class="alternative-amount">
                {{selectedCurrency.type == 'mrt' ? amount.fiatStr : amount.mrtStr}}
            </div>

            <div class="suggested-amounts">
                <button ion-button outline (click)="selectAmount(amount)" *ngFor="let amount of suggestedAmounts[selectedCurrency.type]">
                    {{amount}}
                </button>
            </div>

        </div>

        <ion-item (click)="selectWallet()">
            <ion-avatar item-start img-icon [class.default]="!selectedWallet.color" [style.box-shadow]="selectedWallet.color ? '0 0 0 2px ' + selectedWallet.color : ''">
                <img src="assets/img/icons/wallet.svg">
            </ion-avatar>
            <p>From</p>
            <h2>{{selectedWallet.name}}</h2>
            <p>{{selectedWallet.status ? selectedWallet.status.spendableBalanceStr : '0.00'}} MRT</p>
            <ion-icon name="ios-arrow-down" item-end></ion-icon>
        </ion-item>

        <ion-item (click)="selectFee()">
            <ion-avatar item-start img-icon>
                <img src="assets/img/icons/percent.svg">
            </ion-avatar>
            <p>Fee</p>
            <h2 *ngIf="!txData?.txp?.fee">
                <span *ngIf="!feeLoading">Not calculated</span>
                <ion-spinner *ngIf="feeLoading"></ion-spinner>
            </h2>
            <h2  *ngIf="txData?.txp?.fee">{{txData.txp.fee.description}} - {{txData.txp.fee.percent}}</h2>
            <p *ngIf="txData?.txp?.fee">~{{txData.txp.fee.minutes}} mins</p>
            <div item-end *ngIf="txData?.txp?.fee">
                {{txData.txp.fee.mrt}} MRT <ion-icon name="arrow-down"></ion-icon>
            </div>
        </ion-item>

        <ion-item>
            <ion-avatar item-start></ion-avatar>
            <ion-label>
                Recipient pays fee
                <button ion-button clear (click)="showFeeIncludedTooltip()" class="tooltip-button"><ion-icon name="ios-information-circle-outline"></ion-icon></button>
            </ion-label>
            <ion-toggle [(ngModel)]="feeIncluded" (ionChange)="toggleFeeIncluded($event)"></ion-toggle>
        </ion-item>

        <ion-list *ngIf="sendMethod.type == 'easy'">
            <ion-item>
                <ion-avatar item-start img-icon>
                    <img src="assets/img/icons/unlock.svg">
                </ion-avatar>
                <ion-label stacked>Add Password (Optional)</ion-label>
                <ion-input type="password" [(ngModel)]="formData.password" placeholder="Type it here"></ion-input>
            </ion-item>
        </ion-list>

        <ion-list *ngIf="formData.password">
            <ion-item>
                <ion-avatar item-start></ion-avatar>
                <ion-label stacked>Confirm Password</ion-label>
                <ion-input type="password" [(ngModel)]="formData.confirmPassword" placeholder="Repeat password"></ion-input>
            </ion-item>
        </ion-list>

        <!--<ion-item *ngIf="sendMethod.type == 'easy'">-->
            <!--<ion-avatar item-start img-icon>-->
                <!--<img src="assets/img/icons/timeout.svg">-->
            <!--</ion-avatar>-->
            <!--<ion-label stacked>Valid till</ion-label>-->
            <!--<ion-label>~{{formData.validTill}} ({{formData.nbBlocks}})</ion-label>-->
            <!--<ion-icon name="arrow-right" item-end></ion-icon>-->
        <!--</ion-item>-->

        <button ion-button full color="primary" (click)="toConfirm()" [disabled]="!isSendAllowed()">
            NEXT <ion-icon name="arrow-right"></ion-icon>
        </button>
    </div>

</ion-content>
