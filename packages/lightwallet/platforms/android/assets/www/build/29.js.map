{"version":3,"sources":["../../src/app/wallets/create-wallet/create-wallet.module.ts","../../src/app/wallets/create-wallet/create-wallet.ts"],"names":[],"mappings":"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","file":"29.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { CreateWalletView } from 'merit/wallets/create-wallet/create-wallet';\n\n@NgModule({\n  declarations: [\n    CreateWalletView,\n  ],\n  providers: [\n  ],\n  imports: [\n    IonicPageModule.forChild(CreateWalletView),\n  ],\n})\nexport class CreateWalletComponentModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/wallets/create-wallet/create-wallet.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, LoadingController, ModalController } from 'ionic-angular';\nimport { ConfigService } from \"merit/shared/config.service\";\nimport { WalletService } from \"merit/wallets/wallet.service\";\nimport { MeritToastController } from \"merit/core/toast.controller\";\nimport { ToastConfig } from \"merit/core/toast.config\";\nimport { Logger } from 'merit/core/logger';\n\nimport * as _ from \"lodash\";\nimport * as Promise from 'bluebird';\nimport { PushNotificationsService } from 'merit/core/notification/push-notification.service';\nimport { PollingNotificationsService } from 'merit/core/notification/polling-notification.service';\nimport { MeritWalletClient } from 'src/lib/merit-wallet-client';\n\n\n\n\n@IonicPage({\n  defaultHistory: ['WalletsView']\n})\n@Component({\n  selector: 'view-create-wallet',\n  templateUrl: 'create-wallet.html',\n})\nexport class CreateWalletView {\n\n  public formData = {\n    walletName: '',\n    unlockCode: '',\n    bwsurl: '',\n    recoveryPhrase: '',\n    password: '',\n    repeatPassword: '',\n    color: '',\n    hideBalance: false\n  }\n\n  public defaultBwsUrl: string;\n\n  constructor(\n    public navCtrl: NavController,\n    public navParams: NavParams,\n    private config: ConfigService,\n    private walletService: WalletService,\n    private loadCtrl: LoadingController,\n    private toastCtrl: MeritToastController,\n    private modalCtrl: ModalController,\n    private logger: Logger,\n    private pushNotificationService: PushNotificationsService,\n    private pollingNotificationService: PollingNotificationsService\n  ) {\n    this.formData.bwsurl = config.getDefaults().bws.url;\n    this.defaultBwsUrl = config.getDefaults().bws.url;\n  }\n\n  ionViewDidEnter() {\n    let unlockCode = this.navParams.get('unlockCode');\n    if (!_.isNil(unlockCode)) {\n      this.formData.unlockCode = unlockCode;\n    }\n  }\n\n  isCreationEnabled() {\n    return (\n      this.formData.unlockCode\n      && this.formData.walletName\n    );\n  }\n\n  selectColor() {\n    let modal = this.modalCtrl.create('SelectColorView', { color: this.formData.color });\n    modal.onDidDismiss((color) => {\n      if (color) {\n        this.formData.color = color;\n      }\n    });\n    modal.present();\n  }\n\n  createWallet(): Promise<any> {\n\n    if (this.formData.password != this.formData.repeatPassword) {\n      this.toastCtrl.create({\n        message: \"Passwords don't match\",\n        cssClass: ToastConfig.CLASS_ERROR\n      }).present();\n    }\n\n    let opts = {\n      name: this.formData.walletName,\n      unlockCode: this.formData.unlockCode,\n      bwsurl: this.formData.bwsurl,\n      mnemonic: this.formData.recoveryPhrase,\n      networkName: this.config.getDefaults().network.name,\n      m: 1, //todo temp!\n      n: 1 //todo temp!\n    };\n\n    let loader = this.loadCtrl.create({\n      content: 'Creating wallet'\n    });\n    loader.present();\n\n\n    return this.walletService.createWallet(opts).then((wallet: MeritWalletClient) => {\n      // Subscribe to push notifications or to long-polling for this wallet.\n      if (this.config.get().pushNotificationsEnabled) {\n        this.logger.info(\"Subscribing to push notifications for default wallet\");\n        this.pushNotificationService.subscribe(wallet);\n      } else {\n        this.logger.info(\"Subscribing to long polling for default wallet\");\n        this.pollingNotificationService.enablePolling(wallet);\n      }\n\n      let promises: Promise<any>[] = [];\n      if (this.formData.hideBalance) {\n        promises.push(this.walletService.setHiddenBalanceOption(wallet.id, this.formData.hideBalance));\n      }\n\n      if (this.formData.password) {\n        promises.push(this.walletService.encrypt(wallet, this.formData.password));\n      }\n      if (this.formData.color) {\n        let colorOpts = { colorFor: {} };\n        colorOpts.colorFor[wallet.id] = this.formData.color;\n        promises.push(this.config.set(colorOpts));\n      }\n      // We should callback to the wallets list page to let it know that there is a new wallet\n      // and that it should updat it's list.\n      let callback = this.navParams.get(\"updateWalletListCB\");\n      return Promise.join(promises).then(() =>{\n        return loader.dismiss().then(() => {\n          return callback().then(() => {\n            this.navCtrl.pop();\n          });\n        });\n      });\n    }).catch((err) => {\n      loader.dismiss();\n      this.logger.error(err);\n      this.toastCtrl.create({\n        message: JSON.stringify(err),\n        cssClass: ToastConfig.CLASS_ERROR\n      }).present();\n    });\n\n  }\n\n\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/wallets/create-wallet/create-wallet.ts"],"sourceRoot":""}