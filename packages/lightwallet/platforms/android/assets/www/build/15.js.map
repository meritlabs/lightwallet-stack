{"version":3,"sources":["../../src/app/wallets/tx-details/tx-details.module.ts","../../src/app/shared/shared.module.ts","../../src/app/shared/to-unit.pipe.ts","../../src/app/shared/to-fiat.pipe.ts","../../src/app/wallets/tx-details/tx-details.ts"],"names":[],"mappings":"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","file":"15.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { TxDetailsView } from 'merit/wallets/tx-details/tx-details';\nimport { SharedModule } from 'merit/shared/shared.module';\nimport { MomentModule } from 'angular2-moment/moment.module';\nimport { WalletService } from 'merit/wallets/wallet.service';\nimport { MnemonicService } from 'merit/utilities/mnemonic/mnemonic.service';\n\n@NgModule({\n  declarations: [\n    TxDetailsView\n  ],\n  imports: [\n    IonicPageModule.forChild(TxDetailsView),\n    SharedModule,\n    MomentModule        \n  ],\n  providers: [\n    WalletService,\n    MnemonicService,\n  ]\n})\nexport class TxDetailsViewModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/wallets/tx-details/tx-details.module.ts","import { NgModule } from '@angular/core';\nimport { GravatarComponent } from 'merit/shared/gravatar.component';\nimport { ToUnitPipe } from 'merit/shared/to-unit.pipe';\nimport { ToFiatPipe } from 'merit/shared/to-fiat.pipe';\nimport { TranslateModule } from '@ngx-translate/core';\n\n// This module manaages the sending of money.\n@NgModule({\n  declarations: [\n    ToUnitPipe,\n    ToFiatPipe\n  ],\n  imports: [\n  ],\n  exports: [\n    ToUnitPipe,\n    ToFiatPipe,\n    TranslateModule\n  ]\n})\nexport class SharedModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/shared/shared.module.ts","import { Pipe, PipeTransform } from '@angular/core';\nimport { ConfigService } from 'merit/shared/config.service';\nimport { TxFormatService } from 'merit/transact/tx-format.service';\n\n@Pipe({ name: 'toUnit' })\nexport class ToUnitPipe implements PipeTransform {\n  private unitCode: string;\n  \n  constructor(\n    private configProvider: ConfigService,\n    private txFormatProvider: TxFormatService\n  ) {\n    this.unitCode = this.configProvider.get().wallet.settings.unitCode;\n  }\n  transform(value: string, satoshis: number): any {\n    return this.txFormatProvider.formatAmountStr(satoshis);\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/shared/to-unit.pipe.ts","import { Pipe, PipeTransform } from '@angular/core';\nimport { ConfigService } from 'merit/shared/config.service';\nimport { TxFormatService } from 'merit/transact/tx-format.service';\nimport * as Promise from 'bluebird';\n\n@Pipe({ name: 'toFiat' })\nexport class ToFiatPipe implements PipeTransform {\n  private unitCode: string;\n\n  constructor(\n    private configProvider: ConfigService,\n    private txFormatProvider: TxFormatService\n  ) { \n    this.unitCode = this.configProvider.get().wallet.settings.unitCode;\n  }\n  transform(value: string, satoshis: number): Promise<string> {\n    return this.txFormatProvider.formatAlternativeStr(satoshis).then((altSr:string) => {\n      return Promise.resolve(altSr);\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/shared/to-fiat.pipe.ts","import * as _ from 'lodash';\n\nimport { Component } from \"@angular/core\";\nimport { IonicPage, NavParams } from 'ionic-angular';\nimport { TxFormatService } from \"merit/transact/tx-format.service\";\nimport { WalletService } from \"merit/wallets/wallet.service\";\nimport { ProfileService } from \"merit/core/profile.service\";\nimport { Logger } from \"merit/core/logger\";\nimport { VaultsService } from \"merit/vaults/vaults.service\";\nimport { BwcService } from 'merit/core/bwc.service';\nimport { FiatAmount } from 'merit/shared/fiat-amount.model';\nimport { RateService } from 'merit/transact/rate.service';\n\nconst CONFIRMATION_THRESHOLD = 6;\n\n@IonicPage({\n  defaultHistory: ['WalletsView']\n})\n@Component({\n  selector: 'tx-details-view',\n  templateUrl: 'tx-details.html'\n})\nexport class TxDetailsView {\n  public title: string;\n  public wallet: any;\n  public tx: any;\n  public confirmations: string;\n  public vault: any;\n  private bitcore: any;\n  public amountStr: string;\n  private txId: string;\n  \n  constructor(\n    private navParams: NavParams,\n    private txFormatService: TxFormatService,\n    private walletService: WalletService,\n    private vaultService: VaultsService,\n    private profileService: ProfileService,\n    private logger:Logger,\n    private bws: BwcService,\n    private rateService: RateService,\n  ) {\n    this.wallet = this.walletService.getWallet(this.navParams.get('walletId'));\n    this.vault = this.navParams.get('vault');\n    this.txId = this.navParams.get('txId');\n    this.bitcore = this.bws.getBitcore();\n    \n    this.tx = {};\n    this.confirmations = null;\n  }\n\n  ionViewDidEnter() {\n    const vault = this.navParams.get('vault');\n\n    if (vault) {\n      const finish = (list: any) => {\n        let tx = _.find(list, {\n          txid: this.txId\n        });\n\n        if (!tx) throw new Error('Could not get transaction');\n        return this.processTx(tx);\n      };\n\n      this.vaultService.getVaultTxHistory(this.wallet, vault).then((txs) => {\n        const tx = finish(txs);\n        return this.updateTxDetails(tx);\n      });\n    } else {\n      this.walletService.getTx(this.wallet, this.txId).then((tx) => {\n        return this.updateTxDetails(tx);\n      }).catch((err) => {\n        console.log(err);\n      });\n    }\n  }\n\n  addMemo() {\n    return;\n  }\n\n  private viewOnBlockchain() {\n    this.logger.warn(\"Viewing on blockchain is not yet implemented and up for discussion.\")\n  }\n\n  private processTx(tx: any): any {\n    const thisAddr = new this.bitcore.Address(this.vault.address).toString();\n    const summ = _.reduce(tx.outputs, (acc: number, output: any) => {\n      if (output.address != thisAddr) {\n        return acc;\n      }\n      return acc + output.amount;\n    }, 0);\n\n    tx.amount = summ;\n    const amountStr = this.txFormatService.formatAmountStr(summ);\n    tx.amountStr = amountStr;\n    this.amountStr = amountStr;\n    tx.altAmount = this.rateService.fromMicrosToFiat(tx.amount, this.wallet.cachedStatus.alternativeIsoCode);\n    tx.altAmountStr = new FiatAmount(tx.altAmount);\n\n    return tx;\n  }\n\n  private updateTxDetails(tx: any): void {\n    this.tx = tx;\n    if (this.tx.action == 'sent') this.title = 'Sent Funds';\n    if (this.tx.action == 'received') this.title = 'Received Funds';\n    if (this.tx.action == 'moved') this.title = 'Moved Funds';\n\n    if (this.tx.safeConfirmed) this.confirmations = this.tx.safeConfirmed;\n    else if (this.tx.confirmations > CONFIRMATION_THRESHOLD)  this.confirmations = `${CONFIRMATION_THRESHOLD}+`;\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/wallets/tx-details/tx-details.ts"],"sourceRoot":""}