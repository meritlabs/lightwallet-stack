<ion-header>
  <ion-navbar>
    <ion-title>Confirm</ion-title>
  </ion-navbar>
</ion-header>
    
    
<ion-content class="add-bottom-for-cta">
  <div class="list">
    <div class="item head">
      <div class="sending-label">
        <img src="img/icon-tx-sent-outline.svg">
        <span translate *ngIf="!tx.sendMax">Sending</span>
        <span translate *ngIf="tx.sendMax">Sending maximum amount</span>
      </div>
      <div class="amount-label">
        <div class="amount">{{tx.amountValueStr || '...'}} <span class="unit">{{tx.amountUnitStr}}</span></div>
        <div class="alternative">{{tx.alternativeAmountStr || '...'}}</div>
      </div>
    </div>
    <div class="info">
      <div class="item single-line" *ngIf="tx.paypro">
        <span class="label" translate>Payment Expires:</span>
        <span class="item-note" *ngIf="!paymentExpired">{{remainingTimeStr}}</span>
        <span class="item-note" *ngIf="paymentExpired" [style.color]="red" translate>Expired</span>
      </div>

      <div class="item">
        <span class="label" translate>To</span>
        <span class="payment-proposal-to" *ngIf="!recipientType">
          <img src="img/icon-bitcoin-small.svg">

          <div copy-to-clipboard="tx.toAddress" *ngIf="!tx.paypro" class="ellipsis">
            <contact *ngIf="!tx.toName" address="{{tx.toAddress}}"></contact>
            <span class="m15l size-14" *ngIf="tx.toName">{{tx.toName}}</span>
          </div>

          <div *ngIf="tx.paypro" (click)="openPPModal(tx.paypro)" class="m15l size-14 w100p pointer">
            <i *ngIf="tx.paypro.verified && tx.paypro.caTrusted" class="ion-locked" style="color:green"></i>
            <i *ngIf="!tx.paypro.caTrusted" class="ion-unlocked" style="color:red"></i>
            <span class="ellipsis" *ngIf="!tx.toName">{{tx.paypro.domain || tx.paypro.toAddress}}</span>
            <span *ngIf="tx.toName">{{tx.toName}}</span>
          </div>
          <!-- <contact *ngIf="!tx.hasMultiplesOutputs" class="ellipsis" address="{{tx.toAddress}}"></contact>
          <span *ngIf="tx.hasMultiplesOutputs" translate>Multiple recipients</span> -->
        </span>
        <div class="wallet" *ngIf="recipientType == 'wallet'">
          <i class="icon big-icon-svg">
            <img src="img/icon-wallet.svg" [class.wallet-background-color-default]="!toColor" [style.background-color]="toColor" class="bg"/>
          </i>
          <div copy-to-clipboard="tx.toAddress" class="ellipsis">
            <contact *ngIf="!tx.toName" address="{{tx.toAddress}}"></contact>
            <span *ngIf="tx.toName" class="wallet-name">{{tx.toName}}</span>
          </div>
        </div>
        <div *ngIf="recipientType == 'contact' && !isChromeApp" class="gravatar-contact toggle" (click)="toggleAddress()">
          <gravatar class="send-gravatar" name="{{tx.toName}}" height="30" width="30" email="{{toEmail}}"></gravatar>
          <span *ngIf="tx.toName && !showAddress">{{tx.toName}}</span>
          <span *ngIf="tx.toName && showAddress">{{tx.toAddress}}</span>
        </div>
      </div>
      <a class="item item-icon-right" *ngIf="wallet" (click)="showWalletSelector()">
        <span class="label" translate>From</span>
        <div class="wallet" *ngIf="wallet">
          <i class="icon big-icon-svg">
            <img src="img/icon-wallet.svg" [class.wallet-background-color-default]="!wallet.color" [style.background-color]="wallet.color" class="bg"/>
          </i>
          <div>{{wallet.name}}</div>
        </div>
        <div class="wallet" *ngIf="!wallet">
          <i class="icon big-icon-svg">
            <img src="img/icon-wallet.svg" [style.background-color]="grey" class="bg"/>
          </i>
          <div>...</div>
        </div>
        <i class="icon bp-arrow-right"></i>
      </a>
      <div class="item item-icon-right" *ngIf="wallet" (click)="chooseFeeLevel(tx, wallet)">
        <span class="label">{{'Fee:' | translate}} {{tx.feeLevelName | translate}}</span>
        <span class="m10l">{{tx.txp[wallet.id].feeStr || '...'}}</span>
        <span class="item-note m10l">
          <span>{{tx.txp[wallet.id].alternativeFeeStr || '...'}}&nbsp;
          <span class="fee-rate" *ngIf="tx.txp[wallet.id].feeRatePerStr"> &middot;
              <i class="ion-alert-circled warn" *ngIf="tx.txp[wallet.id].feeToHigh"></i> &nbsp;
              <span class="fee-rate" [class.warn]="tx.txp[wallet.id].feeToHigh" translate> {{tx.txp[wallet.id].feeRatePerStr}}  of the sending amount </span>

          </span>
        </span>
        </span>

        <i class="icon bp-arrow-right"></i>
      </div>
      <a class="item item-icon-right" *ngIf="wallet" (click)="showDescriptionPopup(tx)">
        <span class="label" translate>Add Memo</span>
        <span class="item-note m10l">
          {{tx.description}}
        </span>
        <i class="icon bp-arrow-right"></i>
      </a>
      <div class="text-center" *ngIf="noWalletMessage">
        <span class="badge badge-energized">{{noWalletMessage}}</span>
      </div>
    </div>
  </div>
</ion-content>

<click-to-accept
  (click)="approve(tx, wallet, statusChangeHandler)"
  *ngIf="(!isCordova || isWindowsPhoneApp) && wallet"
  click-send-status="sendStatus"
  is-disabled="!wallet">
  {{buttonText}}
</click-to-accept>
<slide-to-accept
  *ngIf="isCordova && !isWindowsPhoneApp && wallet"
  slide-on-confirm="approve(tx, wallet, statusChangeHandler)"
  slide-send-status="sendStatus"
  is-disabled="!wallet">
  {{buttonText}}
</slide-to-accept>
<slide-to-accept-success
  slide-success-show="sendStatus === 'success'"
  slide-success-on-confirm="onSuccessConfirm()"
  slide-success-hide-on-confirm="true">
  <span *ngIf="wallet.m == 1 && (wallet.canSign() || wallet.isPrivKeyExternal())" translate>Payment Sent</span>
  <span *ngIf="wallet.m > 1 && (wallet.canSign() || wallet.isPrivKeyExternal())" translate>Proposal Created</span>
  <span *ngIf="!wallet.canSign() && !wallet.isPrivKeyExternal()" translate>Transaction Created</span>
</slide-to-accept-success>

<wallet-selector
  wallet-selector-title="walletSelectorTitle"
  wallet-selector-wallets="wallets"
  wallet-selector-selected-wallet="wallet"
  wallet-selector-show="walletSelector"
  wallet-selector-on-select="onWalletSelect">
</wallet-selector>
