#!/bin/bash

root_dir="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)/.."

cd "${root_dir}"

tarball_name=`node bin/get-tarball-name.js`
bucket_name="bitcore-node"
binary_url="https://${bucket_name}.s3.amazonaws.com/${tarball_name}"

echo "Downloading binary: ${binary_url}"

curl $binary_url > $tarball_name

if test -e "${tarball_name}"; then
  echo "Unpacking binary distribution"
  tar -xvzf $tarball_name
  exit 0;
else
  echo "Prebuild binary could not be downloaded, building from source..."
  ./bin/build
fi
